import zio.json._
import model.*

import java.time.ZonedDateTime

object ZioJsonParser extends App {

  given countyDecoder: JsonDecoder[County] = DeriveJsonDecoder.gen[County]
  given roadDecoder: JsonDecoder[Road] = DeriveJsonDecoder.gen[Road]
  given rdDecoder: JsonDecoder[RD] = DeriveJsonDecoder.gen[RD]
  given wgs84Decoder: JsonDecoder[WGS84] = DeriveJsonDecoder.gen[WGS84]
  given detailsDecoder: JsonDecoder[Details] = DeriveJsonDecoder.gen[Details]
  given locationDecoder: JsonDecoder[Location] = DeriveJsonDecoder.gen[Location]
  given textSignDecoder: JsonDecoder[TextSign] = DeriveJsonDecoder.gen[TextSign]
  given trafficSignDecoder: JsonDecoder[TrafficSign] = DeriveJsonDecoder.gen[TrafficSign]
  
  val jsonString =
    """[{"id":13694280,"ndw_id":"0000060f-59b5-44bd-ab87-a76ef43dcc80","type":"updated","schema_version":"3.0","validated":"n","rvv_code":"D3","text_signs":[],"location":{"wgs84":{"latitude":"52.385741385341","longitude":"4.7365452634569"},"rd":{"x":"110703.145","y":"488852.337"},"placement":"L","side":"O","bearing":90,"fraction":0.9411195516586304,"driving_direction":"H","road":{"name":"Haarlemmerstraatweg","wvk_id":"600926943","nwb_version":"2024-03-01"},"county":{"name":"Haarlemmermeer","code":"GM0394","townname":"Halfweg"}},"details":{"image":"https://wegkenmerken.ndw.nu/api/images/46beba13-7b80-42da-9c1c-21da63dfcbc5","first_seen":"2021-07-16","last_seen":"2022-07-12"},"publication_timestamp":"2024-03-26T16:02:50.644Z"},{"id":12338897,"ndw_id":"00000aa3-cfbc-4c00-9cc6-8c35a839b975","type":"updated","schema_version":"3.0","validated":"n","rvv_code":"L8","text_signs":[],"location":{"wgs84":{"latitude":"52.056323787069","longitude":"4.2376440919853"},"rd":{"x":"76158.782","y":"452625.937"},"placement":"L","side":"Z","bearing":180,"road":{"name":"Duke Ellingtonstraat"},"county":{"name":"Den Haag","code":"GM0518","townname":"'s-Gravenhage"}},"details":{"image":"https://wegkenmerken.ndw.nu/api/images/a3945af6-17f5-4cfb-aef9-26ac76951da9","first_seen":"2016-09-06","last_seen":"2022-10-10"},"publication_timestamp":"2023-03-27T22:03:46Z"},{"id":10039136,"ndw_id":"00000d33-cde6-436d-bd5f-eae040751a85","type":"updated","schema_version":"3.0","validated":"n","rvv_code":"B6","text_signs":[],"location":{"wgs84":{"latitude":"51.980076611679","longitude":"6.2908873499929"},"rd":{"x":"217084.103","y":"443905.155"},"placement":"L","side":"O","bearing":90,"fraction":0.8140586614608765,"driving_direction":"H","road":{"name":"Sionstraat","wvk_id":"600862073","nwb_version":"2024-03-01"},"county":{"name":"Doetinchem","code":"GM0222","townname":"Doetinchem"}},"details":{"image":"https://wegkenmerken.ndw.nu/api/images/397c708d-cd5b-446b-b8e5-da62c766fdec","first_seen":"2016-03-15","last_seen":"2022-01-29"},"publication_timestamp":"2024-03-26T16:02:50.780Z"},{"id":12250085,"ndw_id":"000015cd-9127-4192-abca-82ea968b989a","type":"updated","schema_version":"3.0","validated":"n","rvv_code":"G11","text_signs":[],"location":{"wgs84":{"latitude":"52.524329748728","longitude":"6.0638304260417"},"rd":{"x":"200920.141","y":"504288.549"},"placement":"L","side":"Z","bearing":180,"fraction":0.2846204340457916,"driving_direction":"H","road":{"name":"Frankhuizerallee","wvk_id":"600648377","nwb_version":"2024-03-01"},"county":{"name":"Zwolle","code":"GM0193","townname":"Zwolle"}},"details":{"image":"https://wegkenmerken.ndw.nu/api/images/06e004f9-b893-4841-a16f-70570c078549","first_seen":"2016-04-20","last_seen":"2022-02-12"},"publication_timestamp":"2024-03-26T16:02:50.861Z"},{"id":10085907,"ndw_id":"00002ff2-9e78-43f9-9f2c-84a2822b5166","type":"updated","schema_version":"3.0","validated":"n","rvv_code":"D1","text_signs":[],"location":{"wgs84":{"latitude":"51.883100499692","longitude":"5.6085308133845"},"rd":{"x":"170238.473","y":"432752.839"},"placement":"L","side":"W","bearing":270,"fraction":0.0,"driving_direction":"T","road":{"name":"Koningstraat","wvk_id":"600924883","nwb_version":"2024-03-01"},"county":{"name":"Druten","code":"GM0225","townname":"Druten"}},"details":{"image":"https://wegkenmerken.ndw.nu/api/images/bae893a6-c6d9-4b70-99d2-bd5da6e3a3bd","first_seen":"2016-06-30","last_seen":"2022-05-20"},"publication_timestamp":"2024-03-26T16:02:50.968Z"},{"id":13558380,"ndw_id":"00003603-7a43-462c-9e1b-c0d5605da2ff","type":"updated","schema_version":"3.0","validated":"n","rvv_code":"H1","text_signs":[],"location":{"wgs84":{"latitude":"51.871061781463","longitude":"5.2721054483672"},"rd":{"x":"147073.151","y":"431396.486"},"placement":"L","side":"N","bearing":0,"fraction":0.09982501715421677,"driving_direction":"H","road":{"name":"Laageinde","wvk_id":"294262008","nwb_version":"2024-03-01"},"county":{"name":"West Betuwe","code":"GM1960","townname":"Geldermalsen"}},"details":{"image":"https://wegkenmerken.ndw.nu/api/images/d108cdc0-1b3a-477e-a476-42e8350be941","first_seen":"2020-04-21","last_seen":"2022-05-03"},"publication_timestamp":"2024-03-26T16:02:51.018Z"},{"id":11855613,"ndw_id":"000039df-e57e-497f-8b33-2913f9960c1f","type":"created","schema_version":"3.0","validated":"n","rvv_code":"G11","text_signs":[{"type":"VRIJ","text":""}],"location":{"wgs84":{"latitude":"53.104649784311","longitude":"6.8647660928441"},"rd":{"x":"253952.006","y":"569664.261"},"placement":"L","side":"O","bearing":90,"road":{"name":"Julianalaan"},"county":{"name":"Veendam","code":"GM0047","townname":"Veendam"}},"details":{"image":"https://wegkenmerken.ndw.nu/api/images/11b8800c-2430-4df7-bb13-a4d8668c067e","first_seen":"2016-11-25","last_seen":"2022-11-11"},"publication_timestamp":"2023-04-01T14:33:29Z"},{"id":13468098,"ndw_id":"000040a2-1d89-41ed-a120-794723e11b7a","type":"updated","schema_version":"3.0","validated":"n","rvv_code":"F1","text_signs":[],"location":{"wgs84":{"latitude":"51.342039894817","longitude":"5.4473549914586"},"rd":{"x":"159191.228","y":"372536.842"},"placement":"L","side":"Z","bearing":180,"fraction":0.8295443058013916,"driving_direction":"T","road":{"name":"Luikerweg","wvk_id":"317143012","nwb_version":"2024-03-01"},"county":{"name":"Valkenswaard","code":"GM0858","townname":"Valkenswaard"}},"details":{"image":"https://wegkenmerken.ndw.nu/api/images/67aefd31-00cc-4b54-a227-705e00233478","first_seen":"2021-03-29","last_seen":"2022-03-14"},"publication_timestamp":"2024-03-26T16:02:51.248Z"},{"id":13559283,"ndw_id":"00004588-70d0-478e-811d-7a66023c449f","type":"updated","schema_version":"3.0","validated":"n","rvv_code":"B1","text_signs":[],"location":{"wgs84":{"latitude":"52.851235384406","longitude":"6.3264230293746"},"rd":{"x":"218268.159","y":"540861.121"},"placement":"L","side":"O","bearing":90,"fraction":0.9487378597259521,"driving_direction":"H","road":{"name":"Moleneinde","type":"2","number":"855","wvk_id":"600942543","nwb_version":"2024-03-01"},"county":{"name":"Westerveld","code":"GM1701","townname":"Diever"}},"details":{"image":"https://wegkenmerken.ndw.nu/api/images/1ef293cc-95d1-49f3-929e-8abc04140fc9","first_seen":"2021-05-12","last_seen":"2022-05-20"},"publication_timestamp":"2024-03-26T16:02:51.316Z"},{"id":11367151,"ndw_id":"00005004-4183-409a-aa4a-7dca28977bfa","type":"updated","schema_version":"3.0","validated":"n","rvv_code":"A1","black_code":"60","zone_code":"ZO","text_signs":[],"location":{"wgs84":{"latitude":"51.132845082875","longitude":"5.9466707465603"},"rd":{"x":"194160.473","y":"349412.173"},"placement":"L","side":"N","bearing":0,"fraction":0.05077619105577469,"driving_direction":"H","road":{"name":"Linnerweg","wvk_id":"388098016","nwb_version":"2024-03-01"},"county":{"name":"Roerdalen","code":"GM1669","townname":"Montfort"}},"details":{"image":"https://wegkenmerken.ndw.nu/api/images/e950cfec-c9db-4493-9b7a-4a710c60990a","first_seen":"2016-04-19","last_seen":"2022-03-03"},"publication_timestamp":"2024-03-26T16:02:51.382Z"},{"id":11728264,"ndw_id":"00005668-9300-493b-941d-722c833e8d49","type":"updated","schema_version":"3.0","validated":"n","rvv_code":"B1","text_signs":[],"location":{"wgs84":{"latitude":"51.556729246582","longitude":"5.1047358288991"},"rd":{"x":"135410.873","y":"396457.497"},"placement":"L","side":"Z","bearing":180,"fraction":0.6727596521377563,"driving_direction":"H","road":{"name":"Ringbaan-Oost","wvk_id":"600775875","nwb_version":"2024-03-01"},"county":{"name":"Tilburg","code":"GM0855","townname":"Tilburg"}},"details":{"image":"https://wegkenmerken.ndw.nu/api/images/7ba87a76-a1e7-40e9-8e31-e71463eb4564","first_seen":"2016-07-12","last_seen":"2022-06-29"},"publication_timestamp":"2024-03-26T16:02:51.484Z"},{"id":10751057,"ndw_id":"000063a9-98e3-4440-8acb-d702fd2eca2f","type":"updated","schema_version":"3.0","validated":"n","rvv_code":"E1","text_signs":[],"location":{"wgs84":{"latitude":"52.430883199584","longitude":"4.9183867499138"},"rd":{"x":"123115.212","y":"493779.371"},"placement":"L","side":"Z","bearing":180,"fraction":0.8851169347763062,"driving_direction":"T","road":{"name":"Roerdompstraat","wvk_id":"246387025","nwb_version":"2024-03-01"},"county":{"name":"Landsmeer","code":"GM0415","townname":"Landsmeer"}},"details":{"image":"https://wegkenmerken.ndw.nu/api/images/5dae2636-a480-4432-85a8-945f7edbd886","first_seen":"2016-05-18","last_seen":"2022-03-22"},"publication_timestamp":"2024-03-26T16:02:51.571Z"},{"id":10702448,"ndw_id":"000069c5-ca65-4a33-8928-5c8171d56907","type":"updated","schema_version":"3.0","validated":"n","rvv_code":"A1","black_code":"30","zone_code":"ZO","text_signs":[],"location":{"wgs84":{"latitude":"52.1945577804","longitude":"4.4383847772808"},"rd":{"x":"90126.773","y":"467805.98"},"placement":"L","side":"Z","bearing":180,"road":{"name":"De Ruijterstraat"},"county":{"name":"Katwijk","code":"GM0537","townname":"Rijnsburg"}},"details":{"image":"https://wegkenmerken.ndw.nu/api/images/ddb6b9b4-0ffe-40fb-adb8-6e6ac1295baf","first_seen":"2016-04-14","last_seen":"2022-04-13"},"publication_timestamp":"2024-01-28T10:43:47.487Z"},{"id":10296971,"ndw_id":"00006a2c-cd48-47b8-b2e0-8cef6f367f16","type":"updated","schema_version":"3.0","validated":"n","rvv_code":"E1","text_signs":[],"location":{"wgs84":{"latitude":"51.507189049515","longitude":"3.8795557943414"},"rd":{"x":"50335.765","y":"391990.601"},"placement":"L","side":"N","bearing":0,"fraction":0.7805989384651184,"driving_direction":"T","road":{"name":"Klein Frankrijk","wvk_id":"100184053","nwb_version":"2024-03-01"},"county":{"name":"Goes","code":"GM0664","townname":"Goes"}},"details":{"image":"https://wegkenmerken.ndw.nu/api/images/c20a6be0-adb5-4255-9fd8-a953f1d3e74a","first_seen":"2016-12-14","last_seen":"2022-01-20"},"publication_timestamp":"2024-03-26T16:02:51.656Z"},{"id":11453124,"ndw_id":"00006d2c-83b2-4973-afa0-b42cd59e0a04","type":"updated","schema_version":"3.0","validated":"n","rvv_code":"B6","text_signs":[],"location":{"wgs84":{"latitude":"51.875515128186","longitude":"4.5109536872813"},"rd":{"x":"94660.049","y":"432249.232"},"placement":"L","side":"W","bearing":270,"fraction":0.8011528253555298,"road":{"name":"Victor Hugoweg","wvk_id":"601073155","nwb_version":"2024-03-01"},"county":{"name":"Rotterdam","code":"GM0599","townname":"Rotterdam"}},"details":{"image":"https://wegkenmerken.ndw.nu/api/images/bb13caa4-c124-419e-8206-074a10bcdcba","first_seen":"2016-07-22","last_seen":"2022-03-08"},"publication_timestamp":"2024-03-26T16:02:51.775Z"},{"id":10489475,"ndw_id":"00006e7a-3556-47d4-bba3-e4f4bc166d1e","type":"updated","schema_version":"3.0","validated":"n","rvv_code":"E1","zone_code":"ZO","text_signs":[],"location":{"wgs84":{"latitude":"52.431655229348","longitude":"6.0763011345689"},"rd":{"x":"201864.642","y":"493985.215"},"placement":"L","side":"W","bearing":270,"fraction":0.9259322881698608,"driving_direction":"T","road":{"name":"Klapperdijk","wvk_id":"403388009","nwb_version":"2024-03-01"},"county":{"name":"Heerde","code":"GM0246","townname":"Wapenveld"}},"details":{"image":"https://wegkenmerken.ndw.nu/api/images/ef51ae41-2d78-47f4-bb31-41a6e890ab46","first_seen":"2016-04-14","last_seen":"2022-06-14"},"publication_timestamp":"2024-03-26T16:02:51.860Z"},{"id":10554351,"ndw_id":"00007466-a4bd-47cd-b0b8-b24685d7cc33","type":"updated","schema_version":"3.0","validated":"n","rvv_code":"D5","black_code":"R","text_signs":[],"location":{"wgs84":{"latitude":"51.482399943117","longitude":"5.6677648490988"},"rd":{"x":"174488.709","y":"388187.851"},"placement":"L","side":"Z","bearing":180,"fraction":0.8913246393203735,"road":{"name":"Heistraat","wvk_id":"348176149","nwb_version":"2024-03-01"},"county":{"name":"Helmond","code":"GM0794","townname":"Helmond"}},"details":{"image":"https://wegkenmerken.ndw.nu/api/images/cb6f5791-c99a-4477-b9e8-87578ad1a194","first_seen":"2016-01-18","last_seen":"2022-01-17"},"publication_timestamp":"2024-03-26T16:02:51.959Z"}]""".stripMargin

  val decoded = jsonString
    .fromJson[List[TrafficSign]]

  println(decoded)
}